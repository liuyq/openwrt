From a2ecb989c7f514ff694e5dc3a2fad88343ef83e5 Mon Sep 17 00:00:00 2001
From: Yongqin Liu <yongqin.liu@linaro.org>
Date: Sun, 12 Aug 2018 15:45:58 +0800
Subject: [PATCH 1/7] update install.sh and ttl.txt file

Signed-off-by: Yongqin Liu <yongqin.liu@linaro.org>
---
 help/ttl.txt | 95 ++++++++++++++++++++++++++++++++++++++++++++++++++++
 install.sh   | 95 ++++++++++++++++++++++++++++++++++++++++++++++++++++
 2 files changed, 190 insertions(+)
 create mode 100644 help/ttl.txt

diff --git a/help/ttl.txt b/help/ttl.txt
new file mode 100644
index 0000000000..41620017cb
--- /dev/null
+++ b/help/ttl.txt
@@ -0,0 +1,95 @@
+http://blog.iytc.net/wordpress/?s=WR743N
+
+1、连接TTL串口
+
+2、在出现“Autobooting in 1 seconds   ”时按下tp两按键（有的说要tpl三个按键）
+
+eth0: 00:00:00:00:e7:00
+eth0 up
+: cfg1 0xf cfg2 0x7214
+eth1: 00:03:7f:ff:ff:fe
+athrs26_reg_init_lan
+ATHRS26: resetting s26
+ATHRS26: s26 reset done
+eth1 up
+eth0, eth1
+Autobooting in 1 seconds
+hornet>
+
+出现“hornet>”提示符
+
+3、查看当前环境变量
+
+hornet> printenv
+bootargs=console=ttyS0,115200 root=31:02 rootfstype=squashfs init=/sbin/init mtdparts=ar7240-nor0:128k(u-boot),1024k(kernel),6912(ro
+otfs),64k(config),64k(ART)
+bootcmd=bootm 0x9f020000
+bootdelay=1
+baudrate=115200
+ethaddr=0x00:0xaa:0xbb:0xcc:0xdd:0xee
+ipaddr=192.168.1.1
+serverip=192.168.1.100
+stdin=serial
+stdout=serial
+stderr=serial
+ethact=eth0
+
+要改变 服务器地址可以用setenv serverip 192.168.1.181
+
+4、计算机与路由器LAN相连，IP设置为192.168.1.100 ，开启tftp服务器
+
+5、tftp上传固件
+
+执行如下命令：
+
+ tftpboot 0x80000000 743.bin 
+
+ 注意：如果是8M flash把0x3c0000修改为0x7c0000
+
+  erase 0x9f020000 +0x3c0000
+
+  注意：如果是8M flash把0x3c0000修改为0x7c0000
+
+   cp.b 0x80000000 0x9f020000 0x3c0000
+
+   示例：
+
+   hornet> tftpboot 0x80000000 743.bin
+   dup 1 speed 1000
+   Using eth1 device
+   TFTP from server 192.168.1.100; our IP address is 192.168.1.1
+   Filename '743.bin'.
+   Load address: 0x80000000
+   Loading: *#################################################################
+   #################################################################
+   #################################################################
+   #################################################################
+   #################################################################
+   #################################################################
+   #################################################################
+   #################################################################
+   #################################################################
+   #################################################################
+   #################################################################
+   ######################################################
+   done
+   Bytes transferred = 3932160 (3c0000 hex)
+   hornet> erase 0x9f020000 +0x3c0000
+
+   First 0x2 last 0x3d sector size 0x10000
+   Erased 60 sectors
+   hornet> cp.b 0x80000000 0x9f020000 0x3c0000
+
+   Copy to Flash... write addr: 9f020000
+   done
+   hornet> boot
+
+   ## Booting image at 9f020000 ...
+   Uncompressing Kernel Image ... OK
+
+   Starting kernel ...
+
+   [ 0.000000] Linux version 3.18.20 (buildbot@builder1) (gcc version 4.8.3 (OpenWrt/Linaro GCC 4.8-2014.04 r46450) ) #1 Fri Sep 4 21:55:57 CEST 2015
+   [ 0.000000] bootconsole [early0] enabled
+
+   输入boot命令重新启动
diff --git a/install.sh b/install.sh
index 224eddfcc5..05e5fa5ac0 100755
--- a/install.sh
+++ b/install.sh
@@ -172,3 +172,98 @@ opkg install luci
 https://en.code-bude.net/2013/02/16/how-to-increase-storage-on-tp-link-wr703n-with-extroot/
 
 https://wiki.openwrt.org/doc/howto/generic.sysupgrade
+
+### install tftp server on ubuntu
+## https://help.ubuntu.com/community/TFTP
+sudo apt-get install tftpd-hpa
+sudo service tftpd-hpa status
+sudo service tftpd-hpa restart
+The default configuration file for tftpd-hpa is /etc/default/tftpd-hpa.
+The default root directory where files will be stored is /var/lib/tftpboot.
+
+# LuCI Essentials
+# https://openwrt.org/zh-cn/doc/howto/luci
+enable ExBoot, and install luci on USB Drive
+
+==============================
+root@OpenWrt:~# opkg list
+base-files - 188-r6693-ec1d7b9
+busybox - 1.28.3-1
+dnsmasq - 2.79-3
+dropbear - 2017.75-5
+firewall - 2018-04-05-35b3e74a-2
+fstools - 2018-02-11-3d239815-1
+fwtool - 1
+hostapd-common - 2018-04-09-fa617ee6-1
+ip6tables - 1.6.2-1
+iptables - 1.6.2-1
+iw - 4.14-1
+iwinfo - 2018-02-15-223e09bf-1
+jshn - 2018-04-12-6eff829d-1
+jsonfilter - 2018-02-04-c7e938d6-1
+kernel - 4.9.91-1-d36eb51ce7cd3df5e7d972b30cc4c8ea
+kmod-ath - 4.9.91+2017-11-01-4
+kmod-ath9k - 4.9.91+2017-11-01-4
+kmod-ath9k-common - 4.9.91+2017-11-01-4
+kmod-cfg80211 - 4.9.91+2017-11-01-4
+kmod-gpio-button-hotplug - 4.9.91-2
+kmod-ip6tables - 4.9.91-1
+kmod-ipt-conntrack - 4.9.91-1
+kmod-ipt-core - 4.9.91-1
+kmod-ipt-nat - 4.9.91-1
+kmod-lib-crc-ccitt - 4.9.91-1
+kmod-mac80211 - 4.9.91+2017-11-01-4
+kmod-nf-conntrack - 4.9.91-1
+kmod-nf-conntrack6 - 4.9.91-1
+kmod-nf-ipt - 4.9.91-1
+kmod-nf-ipt6 - 4.9.91-1
+kmod-nf-nat - 4.9.91-1
+kmod-nf-reject - 4.9.91-1
+kmod-nf-reject6 - 4.9.91-1
+kmod-nls-base - 4.9.91-1
+kmod-ppp - 4.9.91-1
+kmod-pppoe - 4.9.91-1
+kmod-pppox - 4.9.91-1
+kmod-slhc - 4.9.91-1
+kmod-usb-core - 4.9.91-1
+kmod-usb-ehci - 4.9.91-1
+kmod-usb-ledtrig-usbport - 4.9.91-1
+kmod-usb-ohci - 4.9.91-1
+kmod-usb2 - 4.9.91-1
+lede-keyring - 2017-01-20-a50b7529-1
+libblobmsg-json - 2018-04-12-6eff829d-1
+libc - 1.1.19-1
+libgcc - 7.3.0-1
+libip4tc - 1.6.2-1
+libip6tc - 1.6.2-1
+libiwinfo - 2018-02-15-223e09bf-1
+libjson-c - 0.12.1-1
+libjson-script - 2018-04-12-6eff829d-1
+libnl-tiny - 0.1-5
+libpthread - 1.1.19-1
+libubox - 2018-04-12-6eff829d-1
+libubus - 2018-01-16-5bae22eb-1
+libuci - 2018-03-24-5d2bf09e-1
+libuclient - 2017-11-02-4b87d831-1
+libxtables - 1.6.2-1
+logd - 2018-02-14-128bc35f-1
+mtd - 21
+netifd - 2018-04-03-3dc8c916-1
+odhcp6c - 2018-05-04-474b5a3a-11
+odhcpd-ipv6only - 1.5-1
+opkg - 2017-12-07-3b417b9f-2
+ppp - 2.4.7-12
+ppp-mod-pppoe - 2.4.7-12
+procd - 2018-03-28-dfb68f85-1
+swconfig - 11
+uboot-envtools - 2015.10-1
+ubox - 2018-02-14-128bc35f-1
+ubus - 2018-01-16-5bae22eb-1
+ubusd - 2018-01-16-5bae22eb-1
+uci - 2018-03-24-5d2bf09e-1
+uclient-fetch - 2017-11-02-4b87d831-1
+usign - 2015-07-04-ef641914-1
+wireless-regdb - 2017-10-20-4343d359
+wpad-mini - 2018-04-09-fa617ee6-1
+root@OpenWrt:~# 
+========================================
-- 
2.20.1

